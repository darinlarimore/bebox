<!DOCTYPE html>
<html >
<head>
  <meta charset="UTF-8">
  <title>Bebox v6 responsive</title>


  <link rel='stylesheet prefetch' href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css'>

      <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      background-color:white;
      text-align:center;
      color: #777;
      margin: 0;
    }

    #slider {
      width:400px;
      margin:30px auto;
      background-color: #222;
      display: inline-block;
    }

    #slider, #slider a {
      background-image: none;
      border: 1px solid #555;
    }
    #slider a {
      background-color: #444;
    }

    #wordsDiv {
      font-family: 'Permanent Marker', cursive;
      font-size: 110px;
      font-weight: 800;
      text-align: center;
      -webkit-user-select: none;  /* Chrome all / Safari all */
      -moz-user-select: none;     /* Firefox all */
      -ms-user-select: none;      /* IE 10+ */
      user-select: none;
    }

    #button {
      cursor: pointer;
    }

    #container {
       padding-top: 145px;
    }

    #photo {
      background-size: contain;
      border: none;
      position: relative;
       -webkit-filter: grayscale(1);
      filter: grayscale(1);
    }
  </style>

</head>

<body>
  <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">

<div id="container">
  <svg version="1.1" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     x="0px" y="0px" viewBox="0 0 1300 600" xml:space="preserve">

<!--photo -->
    <svg id="photo-div" opacity="0" x="45" y="0">
      <g>
        <image id="photo" x="200" y="225" width="200px" height="200px" href=""/>
        <rect id="photo-box" x="200" y="225" fill="none" stroke="#222326" stroke-linecap="square" stroke-width="7" stroke-miterlimit="30" width="200" height="200"/>
      </g>
    </svg>
    <!--be square -->
  <g id="button" x="135" y="225" width="310" height="200">
    <rect id="be-box" x="135" y="225" fill="none" stroke="#222326" stroke-linecap="square" stroke-width="7" stroke-miterlimit="30" width="310" height="200"/>
    <svg id="be" x="194px" y="270px" width="194px" height="108px" viewBox="0 0 96.8 53.9">
      <path fill="white" d="M44.4,30c-2-2.5-4.7-4-8.1-4.7c2.9-0.8,5.1-2.2,6.8-4.3c1.7-2.1,2.5-4.6,2.5-7.4c0-2.8-0.8-5.2-2.5-7.2
        c-1.6-2.1-4-3.6-7-4.7C33.2,0.6,29.7,0,25.6,0H0v53.9h26.6c4.2,0,7.9-0.6,11-1.8c3.1-1.2,5.5-2.9,7.2-5.2c1.7-2.3,2.5-4.9,2.5-8
        C47.4,35.4,46.4,32.5,44.4,30z M30.7,41.5c-1.4,1-3.4,1.5-5.8,1.5H14.1v-7.6v-3.7V21.5v-3.9V11h10.8c1.9-0.1,3.5,0.4,4.6,1.3
        c1.1,0.9,1.7,2.2,1.7,3.8c0,1.7-0.6,3-1.7,4c-1.1,0.9-2.7,1.4-4.6,1.4h-4.1v10.2h4.1c2.5-0.1,4.4,0.4,5.8,1.4c1.4,1,2.2,2.3,2.2,4
        C32.8,39,32.1,40.4,30.7,41.5z"/>
      <polygon fill="white" points="67.6,42.7 67.6,32.5 93.3,32.5 93.3,21.3 67.6,21.3 67.6,11.2 96.1,11.2 96.1,0 53.5,0 53.5,53.9
      96.8,53.9 96.8,42.7"/>
    </svg>
  </g>


<!--text box -->
    <rect id="textbox" x="445" y="25" fill="transparent" stroke="#222326" stroke-linecap="square" stroke-width="7" stroke-miterlimit="30" width="750" height="200"/>
  <text x="505px" y="160px" width="96.8px" height="53.9px" color="#FFFFFF" id="wordsDiv"></text>



  </svg>
</div>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
<script src='http://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenMax.min.js'></script>
<script src='http://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/DrawSVGPlugin.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/TextPlugin.min.js'></script>

    <script language="JavaScript">
    var jsonSource = "https://api.airtable.com/v0/appHy9VHiciXJsXF4/Design%20Projects?api_key=key9zM2eKD4GJ1VVX",
       bebox = $("#be-box"),
       be = $ ("#be"),
       button = $ ("#button"),
       clicked = false,
       textbox = $("#textbox"),
       text = $(".text"),
       photo = $("#photo"),
       bgContainer = $("#container"),
       photoDiv = $("#photo-div"),
       bgLine = new TimelineMax({repeat: 0}),
       textLine = new TimelineMax({repeat:-1}),
       beBox =  new TimelineMax({repeat:0}),
       beBoxColor =  new TimelineMax({repeat:0, yoyo:true}),
       once = new TimelineMax({repeat:0}),
       wordChange =  new TimelineMax({repeat:-1}),
       imageChange =  new TimelineMax({repeat:0}),
       wordsDiv = $("#wordsDiv"),
       imgDiv = $("#imgDiv"),
       colors = ["#F6D85F", "#59B2DE", "#6AB78B", "#835B9F", "#C83932", "black"],
       bgColors = ["#F6D85F", "#59B2DE", "#6AB78B", "#835B9F", "#C83932"],
       words = [],
       nextWord = [];

       function randomColor(t) {
         var daColor = colors[Math.floor(Math.random() * colors.length)];
           beBox.staggerTo(bgContainer, 1, {css: {backgroundColor: "transparent"}})
           .staggerTo(bebox, t, {fill:daColor})


       }

       function complete() {
         var key = words[Math.floor(Math.random() * words.length)],
             randWord = key.phrase,
             funnyPhoto = key.photo;
         if(randWord.length >= 12){
           once.to(wordsDiv, 0, {opacity: 0, css:{fontSize: "80px"}, text:{value:randWord, delimiter:""}, ease:Linear.easeNone})
           .to(photo, 0, {attr:{href:funnyPhoto}, transformOrigin:"50% 50%"})
           .staggerTo(textbox, 1, {attr:{ width: (wordsDiv.width() - 885)}, onRepeat:swapImage()})
           .to(wordsDiv, 1, {opacity: 1, onRepeat:randomColor(7)})
           .staggerTo(wordsDiv, 1, {opacity: 1})
           .staggerTo(wordsDiv, 1, {opacity: 0})
         } else if(randWord.length <= 12){
           once.to(wordsDiv, 0, {opacity: 0, css:{fontSize: "110px"}, text:{value:randWord, delimiter:""}, ease:Linear.easeNone})
           .to(photo, 0, {attr:{href:funnyPhoto}, transformOrigin:"50% 50%"})
           .staggerTo(textbox, 1, {attr:{ width: (wordsDiv.width() - 885)}, onRepeat:swapImage()})
           .to(wordsDiv, 1, {opacity: 1, onRepeat:randomColor(7)})
           .staggerTo(wordsDiv, 1, {opacity: 1})
           .staggerTo(wordsDiv, 1, {opacity: 0})
         }
       };

       function swapImage() {
         var randomChange = Math.random();
         if (randomChange >= 0.5) {
          imageChange.staggerTo(photoDiv, 1, {attr:{opacity: 1, x: 245}})
          .staggerTo(photoDiv, 3, {attr:{opacity: 1, x: 245}})
          .staggerTo(photoDiv, 1, {attr:{opacity: 0, x: 45}})
         }
          else if (randomChange < 0.5) {
          imageChange.staggerTo(photoDiv, 1, {attr:{opacity: 1, y: -200}})
          .staggerTo(photoDiv, 3, {attr:{opacity: 1, y: -200}})
          .staggerTo(photoDiv, 1, {attr:{opacity: 0, y: 0}})
         }
       };


    function animate() {
       beBox.fromTo(bebox, 1, {drawSVG:"0%", fill: "white"}, {drawSVG:"10%"}, "+=0.1")
       .staggerTo(bebox, 1, {drawSVG:"90% 100%"}, 0.5)
       .staggerTo(bebox, 1, {drawSVG:"100%"}, {drawSVG:"10%"}, "+=0.1")
       .staggerTo(bebox, 1, {fill: "black", stroke:"black", scale:1, opacity:1}, 0.2)

       beBox.from(be, 1, {opacity:0}, 1)

       textLine.fromTo(textbox, 1, {drawSVG:"0%"}, {drawSVG:"10%"}, "+=0.1")
       .staggerTo(textbox, 1, {drawSVG:"95% 100%"}, 0.5)
       .staggerTo(textbox, 1, {drawSVG:"100%", stroke:"black", onComplete:complete}, {drawSVG:"10%"}, "+=0.1")
       .staggerTo(textbox, 2.9, {drawSVG:"100%" })
       .staggerTo(textbox, 1, {opacity: 0})
       .staggerTo(textbox, 1.5, {opacity: 0})
       // console.log(words)
   };

     button.click(function() {
       var daColor = colors[Math.floor(Math.random() * colors.length)];

           beBoxColor.staggerTo(bebox, 0, {fill:daColor})
           .staggerTo(bebox, .2, {scale:1.5, transformOrigin: "50% 50%", ease: Elastic.easeOut.config(2, 1)}, 3)
           .staggerTo(bebox, .2, {scale:1, transformOrigin: "50% 50%", ease: Elastic.easeOut.config(2, 1), onComplete:bgColor()})
     })


     function bgColor() {
       var bgColor = bgColors[Math.floor(Math.random() * bgColors.length)];
         bgLine.to(bgContainer, .3, {css: {backgroundColor: bgColor}})
     }

     //fetch the json feed
     $.getJSON( jsonSource, function() {
       $("").prependTo("#container");
     }).done(function(data) {
       if (data) {
         $.each(data.records, function( i, item ) {
           if (item.fields.Phrase !== undefined && item.fields.colorphoto !== undefined) {
             words.push({
               phrase: item.fields.Phrase,
               photo: item.fields.colorphoto[0].url});
            }
         }).done(animate())

       } else {
         // if the json request is successful but there are no items
         $("<p>JSON request succeeded but no data returned.</p>").prependTo("#container");
       }
     })

     .fail(function() {
       $("<p>JSON request fail</p>").prependTo("#container");
     })

     .error(function() {
       $("<p>JSON request error</p>").prependTo("#container");
     });
    </script>

</body>
</html>
